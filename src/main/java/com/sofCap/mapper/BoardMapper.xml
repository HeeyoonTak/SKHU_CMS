<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sofCap.mapper.BoardMapper">
	<select id="findById" resultType="BoardDto">
		SELECT * FROM Board WHERE id =
		#{id}
	</select>

	<select id="findByClubId_p" resultType="BoardDto">
		SELECT b.*
		FROM Board b
		LEFT JOIN Club c ON b.club_id = c.id
		WHERE club_id = #{id} AND
		board_name_id = '1'
	</select>

	<select id="findOne" resultType="BoardDto">
		SELECT *
		FROM Board
		WHERE id =
		#{id}
	</select>

	<select id="findAll_p" resultMap="resultMap_BoardDto">
		SELECT b.*, c.club_name
		FROM
		Board b
		LEFT JOIN Club c ON b.club_id = c.id
		WHERE board_name_id = '1'
		ORDER BY
		date
		DESC
	</select>

	<select id="findAll_r" resultMap="resultMap_BoardDto">
		SELECT b.*, c.club_name
		FROM
		Board b
		LEFT JOIN Club c ON b.club_id = c.id
		WHERE board_name_id = '2'
	</select>

	<select id="findAll_n" resultType="BoardDto">
		SELECT *
		FROM Board
		WHERE
		board_name_id = '3' AND club_id = '1'
	</select>

	<select id="findAll_m" resultType="BoardDto">
		SELECT *
		FROM Board
		WHERE
		board_name_id = '4' AND club_id = '1'
	</select>

	<select id="listFive_p" resultType="BoardDto">
		SELECT *
		FROM board
		WHERE
		board_name_id = 1
		ORDER BY
		date
		DESC LIMIT 5;
	</select>

	<select id="listFive_r" resultType="BoardDto">
		SELECT *
		FROM board
		WHERE
		board_name_id = 2
		ORDER BY
		date
		DESC LIMIT 5;
	</select>

	<delete id="delete">
		DELETE FROM Board WHERE id = #{id}
	</delete>

	<insert id="insert" useGeneratedKeys="true" keyProperty="id">
		INSERT Board(board_name_id, title, content, date, club_id, start_date,
		end_date)
		VALUES (#{board_name_id}, #{title}, #{content}, date_format(now(), '%Y-%m-%d'), #{club_id}, #{start_date}, #{end_date})
	</insert>

	<update id="update" useGeneratedKeys="true" keyProperty="id">
		UPDATE Board SET
		title = #{title},
		content = #{content},
		date = date_format(now(), '%Y-%m-%d'),
		start_date = #{start_date},
		end_date = #{end_date}
		WHERE id = #{id}
	</update>
	
	<resultMap id="resultMap_BoardDto" type="BoardDto">
		<id property="id" column="id" />
		<result property="title" column="title" />
		<result property="date" column="date" />
		<result property="start_date" column="start_date" />
		<result property="end_date" column="end_date" />
		<association property="club" javaType="ClubDto">
			<id property="id" column="id" />
			<result property="club_name" column="club_name" />
		</association>
	</resultMap>
</mapper>
